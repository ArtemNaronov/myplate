# MyPlate - Помощник по рецептам и ежедневному меню

Полнофункциональное приложение для управления рецептами, генерации ежедневных меню на основе калорий, бюджета, времени приготовления и наличия ингредиентов, с интеграцией Telegram WebApp.

## Технологический стек

### Frontend
- Next.js 14 (App Router, TypeScript)
- TailwindCSS + shadcn/ui
- React Server Components
- Axios для API вызовов

### Backend
- Go 1.22
- Фреймворк Fiber
- sqlc для доступа к БД
- PostgreSQL 15

### Инфраструктура
- Docker & Docker Compose
- База данных PostgreSQL
- PgAdmin (опционально)

## Возможности

- **Управление рецептами**: Просмотр и детали рецептов
- **Генератор меню**: Создание ежедневных меню на основе:
  - Целевых калорий (±15% допуск)
  - Бюджетных ограничений
  - Ограничений времени приготовления
  - Наличия ингредиентов (кладовая)
- **Цели пользователя**: Установка и управление ежедневными калориями и соотношением макроэлементов
- **Управление кладовой**: Отслеживание имеющихся ингредиентов
- **Списки покупок**: Автоматически генерируемые списки покупок для меню
- **Telegram WebApp**: Полная интеграция с Telegram WebApp

## Структура проекта

```
MyPlate/
├── frontend/          # Next.js приложение
├── backend/           # Go API сервер
│   ├── cmd/api/       # Точка входа приложения
│   ├── internal/      # Внутренние пакеты
│   │   ├── handlers/  # HTTP обработчики
│   │   ├── services/  # Бизнес-логика
│   │   ├── repositories/ # Доступ к данным
│   │   └── models/    # Доменные модели
│   └── pkg/           # Публичные пакеты
├── sql/               # Миграции БД и тестовые данные
└── docker-compose.yml # Конфигурация Docker
```

## Быстрый старт

### Предварительные требования
- Docker и Docker Compose
- Make (опционально, но рекомендуется)

### Запуск приложения

1. **Запустить все сервисы:**
   ```bash
   make up
   ```

2. **Запустить backend API:**
   ```bash
   make api
   ```

3. **Запустить frontend:**
   ```bash
   make next
   ```

4. **Остановить все сервисы:**
   ```bash
   make down
   ```

### Ручная настройка

Если вы предпочитаете запускать сервисы вручную:

1. **Запустить базу данных:**
   ```bash
   docker-compose up -d postgres
   ```

2. **Запустить миграции:**
   ```bash
   # Миграции запускаются автоматически при старте backend
   ```

3. **Запустить backend:**
   ```bash
   cd backend && go run cmd/api/main.go
   ```

4. **Запустить frontend:**
   ```bash
   cd frontend && npm run dev
   ```

## Переменные окружения

### Backend
Создайте `backend/.env`:
```
DATABASE_URL=postgres://myplate:myplate@localhost:5432/myplate?sslmode=disable
JWT_SECRET=ваш-секретный-ключ-здесь
TELEGRAM_BOT_TOKEN=ваш-токен-телеграм-бота
PORT=8080
```

### Frontend
Создайте `frontend/.env.local`:
```
NEXT_PUBLIC_API_URL=http://localhost:8080
NEXT_PUBLIC_TELEGRAM_BOT_NAME=ваше-имя-бота
```

## API Endpoints

### Аутентификация
- `POST /auth/telegram` - Аутентификация через Telegram initData

### Рецепты
- `GET /recipes` - Список всех рецептов
- `GET /recipes/:id` - Детали рецепта

### Меню
- `POST /menus/generate` - Создать ежедневное меню
- `GET /menus/daily` - Получить ежедневное меню

### Цели пользователя
- `POST /users/goals` - Установить цели пользователя
- `GET /users/goals` - Получить цели пользователя

### Кладовая
- `GET /pantry` - Получить продукты кладовой пользователя
- `POST /pantry` - Добавить продукт в кладовую
- `DELETE /pantry/:id` - Удалить продукт из кладовой

### Списки покупок
- `GET /shopping-list/:menu_id` - Получить список покупок для меню

## Схема базы данных

- `users` - Учётные записи пользователей
- `user_goals` - Цели пользователя по калориям и макроэлементам
- `recipes` - Информация о рецептах с ингредиентами (JSONB)
- `pantry_items` - Ингредиенты пользователя
- `menus` - Сгенерированные ежедневные меню
- `shopping_lists` - Списки покупок для меню

## Разработка

### Разработка Backend
```bash
cd backend
go mod download
go run cmd/api/main.go
```

### Разработка Frontend
```bash
cd frontend
npm install
npm run dev
```

### Миграции базы данных
Миграции находятся в `sql/migrations/` и запускаются автоматически при старте backend.

### Тестовые данные
Тестовые данные находятся в `sql/seed.sql` и включают 5-10 примеров рецептов с полными деталями.

## Лицензия

MIT

